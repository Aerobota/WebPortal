<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">

<!-- Use Chrome Frame in IE -->
<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
<!-- Make the application take up the full browser screen and disable user scaling-->
<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">

    <link rel="stylesheet" href="css/fusionmenu.css" type="text/css">
    <link rel="stylesheet" href="css/grid-responsive.css" type="text/css">
    <link rel="stylesheet" href="css/master-a62609d6eda5d94f80052d33c64ee640.css" type="text/css">
    <link rel="stylesheet" href="css/mediaqueries.css" type="text/css">
    <link rel="stylesheet" href="css/rt_graffito-custom.css" type="text/css">
    <link rel="stylesheet" href="css/dialog.css" type="text/css">

<title>SUNSHINE Web Portal</title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />

</head>
<body>
<div id="rt-header" style="width: 100%">
    <div class="rt-container">
        <div class="rt-grid-3 rt-alpha">
            <div class="rt-block logo-block">
            <span class="rt-logo-container">
                <a href="/" id="rt-logo" style="background-image: url(./img/sunshine.png);"></a>
                <span class="logo-color"></span>            </span>
            </div>

        </div>
        <div class="rt-grid-7">
            <div class="rt-block menu-block">
                <div class="rt-menubar fusionmenu">
                    <ul class="menutop level1 ">
                        <li class="item101 active root">
                            <span class="rt-arrow-pointer"></span>
                            <a class="orphan item" href="index.html" id="a-1390553216086585">
                    <span>
                                        Home                                        </span>
                            </a>

                        </li>
                        <li class="item108 root">
                            <span class="rt-arrow-pointer"></span>
                            <a class="orphan item" href="/about" id="a-1390553216088320">
                    <span>
                                        About                                        </span>
                            </a>

                        </li>
                        <li class="item208 root">
                            <span class="rt-arrow-pointer"></span>
                            <a class="orphan item" href="/news" id="a-1390553216088968">
                    <span>
                                        News                                        </span>
                            </a>

                        </li>
                        <li class="item114 parent root f-main-parent">
                            <span class="rt-arrow-pointer"></span>
                            <a class="orphan item" href="#" id="a-1390553216089962">
                    <span>
                                        Project                                        </span>

                            </a>


                        </li>
                        <li class="item117 root">
                            <span class="rt-arrow-pointer"></span>
                            <a class="orphan item" href="login.html" id="a-1390553216091220">
                    <span>
                                        Login                                        </span>
                            </a>

                        </li>
                        <li class="item118 root rt-menu-offset-tablet">
                            <span class="rt-arrow-pointer"></span>
                            <a class="orphan item" href="/contacts" id="a-139055321609245">
                    <span>
                                        Contacts                                        </span>
                            </a>

                        </li>
                    </ul><div class="fusion-pill-l" style="display: block; left: 10px; width: 81px; top: 0px;"><div class="fusion-pill-r"></div></div>
                </div>		<div class="clear"></div>
            </div>

        </div>
        <div class="rt-grid-2 rt-omega">
            <div class="rt-block">
                <div class="rt-social-buttons">
                    <a class="social-button rt-facebook-btn" href="http://www.facebook.com/SunshineProjectEu">
                        <span></span>
                    </a>
                    <a class="social-button rt-twitter-btn" href="https://twitter.com/sunshine_EU">
                        <span></span>
                    </a>
                    <a class="social-button rt-google-btn" href="http://www.linkedin.com/groups/Sunshine-Project-4863590">
                        <span></span>
                    </a>
                    <a class="social-button rt-rss-btn" href="http://www.youtube.com/user/SunshineProjectEu">
                        <span></span>
                    </a>
                </div>
            </div>

        </div>
        <div class="clear"></div>
    </div>
</div>

<script>

    function login(){
        var request = "<login><userName>__USERNAME__</userName><password>__PASSWORD__</password></login>";

        var username = document.getElementById("modlgn-username").value;
        var newpassword = document.getElementById("modlgn-newpasswd").value;
        var password = document.getElementById("modlgn-passwd").value;

        if(defined(newpassword) && defined(password) &&  defined(username) && newpassword!=password){

            var xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4) {
                    if (xmlhttp.status == 400) {alert("Wrong username/password");}
                    if (xmlhttp.status == 200) {

                        //console.log(xmlhttp.responseText);

                        change();
                    }
                }
            }

            request = request.replace("__USERNAME__",username);
            request = request.replace("__PASSWORD__",password);

            xmlhttp.open("POST","https://sunshine.sinergis.it/services/authenticateUser/validateUser",true);
            xmlhttp.setRequestHeader('Content-Type', 'application/xml');
            xmlhttp.setRequestHeader('Accept', 'application/json');
            xmlhttp.send(request);
        }
    }

    function change(){
        var request = "<updatePassword><newPassword>__NEWPASSWORD__</newPassword><oldPassword>__OLDPASSWORD__</oldPassword></updatePassword>";

        var username = document.getElementById("modlgn-username").value;
        var newpassword = document.getElementById("modlgn-newpasswd").value;
        var password = document.getElementById("modlgn-passwd").value;

        if(defined(newpassword) && defined(password) &&  defined(username) && newpassword!=password){

            var key = window.btoa( username + ":" + password);

            var xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4) {
                    if (xmlhttp.status == 400) {alert("Wrong username/password");}
                    if (xmlhttp.status == 200) {

                        console.log(xmlhttp.responseText);
                                window.location="login.html";
                    }
                }
            }

            request = request.replace("__NEWPASSWORD__",newpassword);
            request = request.replace("__OLDPASSWORD__",password);

            request = "body=" + request + "&key=" + key;
            xmlhttp.open("POST","./php/proxyPWD.php",true);
            xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
            xmlhttp.send(request);

            /*xmlhttp.open("POST","https://sunshine.sinergis.it/services/authenticateUser/manageUser",true);
            xmlhttp.setRequestHeader('Content-Type', 'application/xml');
            xmlhttp.setRequestHeader('Accept', 'application/json');
            xmlhttp.setRequestHeader('Authorization', 'Basic ' + key);
            xmlhttp.send(request);*/
        }
    }

    function defined(param){
        if(param == undefined || param == "" || param == null || param == "null") return false;
        return true;
    }
</script>

<div class="rt-container main-surround">
    <div id="rt-mainbody-surround">
        <div id="rt-main" class="mb12">
            <div class="rt-grid-12">
                <div class="rt-block component-block">
                    <div class="rt-grid-4 rt-omega">
                        <div class="rt-block title1">
                            <div class="module-surround">
                                <div class="module-title">
                                    <h2 class="title">Login</h2>
                                </div>
                                <div class="module-content">
                                    <form action="#" method="post" id="login-form">
                                        <fieldset class="userdata">
                                            <p id="form-login-username">
                                                <label for="modlgn-username">User Name</label>
                                                <input id="modlgn-username" type="text" name="username" class="inputbox" size="18">
                                            </p>
                                            <p id="form-login-password">
                                                <label for="modlgn-passwd">Old Password</label>
                                                <input id="modlgn-passwd" type="password" name="password" class="inputbox" size="18">
                                            </p>
                                            <p id="form-login-newpassword">
                                                <label for="modlgn-newpasswd">New Password</label>
                                                <input id="modlgn-newpasswd" type="password" name="password" class="inputbox" size="18">
                                            </p>
                                            <input type="button" name="Submit" class="button" value="Change Password" onclick="login();">
                                        </fieldset>
                                        <!--<ul>
                                            <li>
                                                <a href="/user-profile?view=registration">
                                                    Create an account</a>
                                            </li>
                                        </ul>-->
                                    </form>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            <div class="clear"></div>
        </div>
    </div>
</div>
<footer id="rt-footer-surround">
    <div id="rt-footer">
        <div class="rt-container">
            <div class="rt-grid-4 rt-alpha">
                <div class="rt-block title1">
                    <div class="module-surround">
                        <div class="module-title">
                            <h2 class="title">Project Funding</h2>
                        </div>
                        <div class="module-content">


                            <div class="customtitle1">
                                <div class="gantry-width-block">
                                    <span style="color:#e3d84b">SUNSHINE</span>  is supported by the Competitiveness and Innovation Framework Programme (CIP) 2007 - 2013
                                </div>
                                <div class="gantry-width-block">
                                    Call Identifier: CIP-ICT-PSP-2012-6
                                </div>
                                <div class="gantry-width-block" style="padding-top:20px">
                                    <img src="./img/cip.png" border="0" alt="CIP" style="border: 0;height:80px;width:280px;margin-left:35px">
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="rt-grid-4">
                <div class="rt-block title1 hidden-phone">
                    <div class="module-surround">
                        <div class="module-title">
                            <h2 class="title">Project Coordinator</h2>
                        </div>
                        <div class="module-content">


                            <div class="customtitle1 hidden-phone">
                                <div class="gantry-width-10 gantry-width-block">
                                    <span class="icon-user largemarginbottom largepaddingbottom"></span>
                                </div>
                                <div class="gantry-width-90 gantry-width-block">
                                    <span style="color:#e3d84b">Raffaele de Amicis</span>
                                </div>

                                <div class="clear">&nbsp;</div>

                                <div class="gantry-width-10 gantry-width-block">
                                    <span class="icon-home largemarginbottom largepaddingbottom"></span>
                                </div>
                                <div class="gantry-width-90 gantry-width-block">
                                    <span style="color:#e3d84b">Fondazione GraphiTech</span><br>
    <span>via Alla Cascata, 56/C<br>
      38123, Trento, Italy</span>
                                </div>

                                <div class="clear">&nbsp;</div>

                                <div class="gantry-width-10 gantry-width-block">
                                    <span class="icon-phone largemarginbottom largepaddingbottom"></span>
                                </div>
                                <div class="gantry-width-90 gantry-width-block">
                                    <span style="color:#e3d84b">+39 (0461) 283395</span>
                                </div>

                                <div class="clear">&nbsp;</div>

                                <div class="gantry-width-10 gantry-width-block">
                                    <span class="icon-print largemarginbottom largepaddingbottom"></span>
                                </div>
                                <div class="gantry-width-90 gantry-width-block">
                                    <span>+39 (0461) 283398</span>
                                </div>

                                <div class="clear">&nbsp;</div>

                                <div class="gantry-width-10 gantry-width-block hidden-tablet">
                                    <span class="icon-envelope-alt largemarginbottom largepaddingbottom"></span>
                                </div>
                                <div class="gantry-width-90 gantry-width-block hidden-tablet">
                                    <span style="color:#e3d84b">coordinator@sunshineproject.eu</span>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="rt-grid-4 rt-omega">
                <div class="rt-block title1 hidden-phone">
                    <div class="module-surround">
                        <div class="module-title">
                            <h2 class="title">Social Networks</h2>
                        </div>
                        <div class="module-content">


                            <div class="customtitle1 hidden-phone">
                                <p style="text-align:justify">You can stay connected and updated on the <span style="color: #e3d84b;">SUNSHINE</span> project developments even through the most popular social network.</p>
                                <table width="100%" border="0">
                                    <tbody><tr>
                                        <td align="center"><a href="http://www.facebook.com/SunshineProjectEu"><img src="./img/facebook.png" alt="" width="50px"></a></td>
                                        <td align="center"><a href="https://twitter.com/sunshine_EU"><img src="./img/twitter.png" alt="" width="50px"></a></td>
                                        <td align="center"><a href="http://www.linkedin.com/groups/Sunshine-Project-4863590"><img src="./img/linkedin.png" alt="" width="50px"></a></td>
                                        <td align="center"><a href="http://www.youtube.com/user/SunshineProjectEu"><img src="./img/youtube.png" alt="" width="50px"></a></td>
                                    </tr>
                                    </tbody></table>



                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="clear"></div>
        </div>
    </div>
</footer>
</body>
</html>